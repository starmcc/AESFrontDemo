<html>

<head>
    <title>AES加解密 -- 浅梦</title>
    <style type="text/css">
        textarea {
            resize:none;
        }
        div {
            margin: 0 0;
            width: 30%;
            background: lavender;
        }
        p {
            font: red;
        }
        button {
            width: 80px;
            height: 50px;
        }
    </style>
</head>

<body>
<!-- 密文 -->
<h1>AES 工具测试 -- 浅梦</h1>
<div>
    <label for="miwen">密文</label>
    <textarea rows="5" cols="30" id="miwen"></textarea>
    <br/>
    <label for="mingwen">明文</label>
    <textarea rows="5" cols="30" id="mingwen">测试文本1@#@!y58sa*&>*%@!~测试文本</textarea>
    <br/>
    <label for="miyao">秘钥</label>
    <textarea rows="5" cols="30" id="miyao">testmiyao</textarea>
    <p id="msg">请点击按钮进行测试</p>
    <button type="button" id="jiami">加密</button>
    <button type="button" id="jiemi">解密</button>
    <button type="button" id="qingkong">清空</button>
</div>
</body>

</html>
<script src="js/crypto-js-3.1.9-1/crypto-js.js"></script>
<script>

    (function(){
        var jiami = document.getElementById("jiami");
        var jiemi = document.getElementById("jiemi");
        var miwen = document.getElementById("miwen");
        var mingwen = document.getElementById("mingwen");
        var miyao = document.getElementById("miyao");
        var msg = document.getElementById("msg");
        var qingkong = document.getElementById("qingkong");
        jiami.onclick = function(){
            msg.innerText = '开始加密';
            var data = encrypt(mingwen.value, miyao.value);
            miwen.value = data;
            console.info('加密后：' + data);
            msg.innerText = '加密成功！F12查看控制台信息';

        };

        jiemi.onclick = function(){
            msg.innerText = "开始解密";
            var data = decrypt(miwen.value, miyao.value);
            mingwen.value = data;
            console.info('解密后：' + data);
            msg.innerText = '解密成功！F12查看控制台信息';
        };

        qingkong.onclick = function(){
            miwen.value = '';
            mingwen.value = '';
            miyao.value = '';
            msg.innerText = '清空成功';
        };
    })();


    function createMD5(data,key) {
        var str = data+'|'+key;
        var md5Str = CryptoJS.MD5(str).toString(CryptoJS.enc.Base64);
        return md5Str;
    }

    function getKey(key) {
        var realKey = CryptoJS.SHA1(key);
        realKey = CryptoJS.SHA1(realKey).toString().substring(0, 32); //真正的key
        return realKey;
    }

    function encrypt(data,key) {
        var realKey = getKey(key);
        var encrypt = CryptoJS.AES.encrypt(data, CryptoJS.enc.Hex.parse(realKey), {
            mode: CryptoJS.mode.ECB,
            padding: CryptoJS.pad.Pkcs7
        });
        return encrypt.ciphertext.toString(CryptoJS.enc.Base64);
    }

    function decrypt(data,key) {
        var realKey = getKey(key);
        var decrypt = CryptoJS.AES.decrypt({
            ciphertext: CryptoJS.enc.Base64.parse(data)
        }, CryptoJS.enc.Hex.parse(realKey), {
            mode: CryptoJS.mode.ECB,
            padding: CryptoJS.pad.Pkcs7
        });
        return decrypt.toString(CryptoJS.enc.Utf8);
    }

</script>